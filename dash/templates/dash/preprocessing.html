{% extends "dash/dash-base-temp.html" %}
{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item "><a href="{% url 'upload' %}">Upload</a></li>
        <li class="breadcrumb-item active" aria-current="page"><a href="{% url 'index' %}">Select File</a></li>
        <li class="breadcrumb-item " aria-current="page">Data Preprocessing</li>
    </ol>
</nav>
<h4>File name:- {{ file_name }} <span class="badge badge-danger"> Rows count : {{ row_count }} </span></h4>
<table class="table table-responsive table-striped table-dark " width="100%" id="dataTable"  cellspacing="0">
    <thead>
    <tr>
        {% for columns in DataFrame %}
        <th>{{ columns | safe }}</th>
        {% endfor %}
    </tr>
    </thead>
    <tbody>
    {% for _, data in DataFrame.iterrows %}
    <tr>
        {% for value in data %}
        <td>{{ value | safe }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
    </tbody>
</table>
<form method="POST" action="." enctype="multipart/form-data">
    {% csrf_token %}
    <div class="table-responsive jumbotron">
        <h3> Select variables</h3>
        <table class="table table-sm" id="#">
            <thead>
            <tr>
                <th> Column Name </th>
                <th> TYPE </th>
                <th> NAN COUNT </th>
                <th> DISTINCT COUNT </th>
                <th> SELECT ENCODER </th>
                <th> SELECT DEPENDENT VAR ONE 'Y' </th>
            </tr>
            </thead>
            <tbody>
            {% for key, value, value2, value3 in file_type.itertuples %}
            <tr>
                <td> {{ key }} </td>
                <td>
                    <select class="form-control col-md-8" name="coltype">
                        <option value={{key}}:{{value}}>{{ value }}</option>
                        {% if value == 'object' %}
                        <option value={{key}}:int64>int64</option>
                        <option value={{key}}:float64>float64</option>
                        {% endif %}
                        {% if value == 'int64' %}
                        <option value={{key}}:object>object</option>
                        <option value={{key}}:float64>float64</option>
                        {% endif %}
                        {% if value == 'float64' %}
                        <option value={{key}}:object>object</option>
                        <option value={{key}}:int64>int64</option>
                        {% endif %}
                    </select> </td>
                <td> {{ value2 }} </td>
                <td> {{ value3 }} </td>
                <td>
                    <select class="form-control col-md-8" name="encoding">
                        <option value={{key}}:column_encoder> One Hot Encoder </option>
                        <option value={{key}}:label_encoder> Label Encoder </option>
                        <option value={{key}}:no_encoding> NOT APPLY </option>
                    </select>
                </td>
                <td>
                    <select class="form-control col-md-8" name="assvar">
                        <option value={{key}}:X> X </option>
                        <option value={{key}}:y> Y </option>
                        <option value={{key}}:no> Remove Column </option>
                    </select>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
        <div class="container-fluid">
            <div class="row">
                <div class="form-group col-md-4">
                    <div class="fileUpload">
                        <label> Missing values : </label>
                        <select class="form-control" name="missingvalues" required>
                            <option> </option>
                            <option value='Keep_NAN'>Keep Na Values</option>
                            <option value='Drop_NAN'>Drop Na Values</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-4">
                    <div class="fileUpload ">
                        <label> Imputate NaN Values With : </label>
                        <select class="form-control" name="imputing" required>
                            <option></option>
                            <option value='RDF'>Random Forest</option>
                            <option value='KNN'>KNN Imputer</option>
                            <option value='mean'>Mean</option>
                            <option value='median'>Median</option>
                            <option value='most_frequent'>Most frequent</option>
                            <option value='constant'>Constant</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-4">
                    <div class="fileUpload">
                        <label> Training Set Size % : </label>
                        <input class="form-control col-md-8" type="number" max="100" accuracy="1" min="0" name="trainingset_size" value="75" id="trainingset_size">
                    </div>
                </div>



            </div>
        </div>
        <div class="fileUpload btn btn-primary">
            <span>Submit</span>
            <div>
                <input type="Submit" name="prepross_submit" class="upload">
            </div>
        </div>
    </div>
</form>
<h1>{{selecty}}</h1>

{% if graph %}

<div class="jumbotron">
    <div class="row">
        <div class="col-md-6">
            <h5><b>Selected X Variables:</b> {{ xcols }}</h5>
        </div>
        <div class="col-md-6">
            <h5><b>Selected Y Variable:</b> {{ ycol }}</h5>
        </div>
        <hr>
        <div class="col-md-6">
            <h5><b>Missing Values:</b> {{ missing }}</h5>
        </div>
        <div class="col-md-6">
            <h5><b>Data Imputation Using:</b> {{ imputing }}</h5>
        </div>
        <hr>
        <div class="col-md-6">
            <h5><b>Training Set Size:</b> {{ trainingset_s }}%</h5>
        </div>
        <div class="col-md-6">
            <h5><b>Test Set Size:</b> {{ testset_s }}%</h5>
        </div>
        <hr>
        <div class="col-md-6">
            <h5><b>Col Trans:</b> {{ col_encode_names }}</h5>
        </div>
        <div class="col-md-6">
            <h5><b>Label Trans:</b> {{ col_label_names }}</h5>
        </div>

    </div>
</div>
<div class="container-fluid ">
    <h3>Basic Count Plots for Each Selected Feature</h3>
    <div class="row">
        {% for value in graph.values %}
        <div class="col-lg-4 col-xs-6">
            {{ value|safe }}
        </div>
        {% endfor %}
    </div>
</div>
<table class="table table-responsive table-striped table-dark " width="100%"   cellspacing="0">
    <thead>
    <tr>
        {% for columns in x_cols %}
        <th>{{ columns | safe }}</th>
        {% endfor %}
    </tr>
    </thead>
    <tbody>
    {% for _, data in x_cols.iterrows %}
    <tr>
        {% for value in data %}
        <td>{{ value | safe }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
    </tbody>
</table>
<table class="table table-responsive table-striped table-dark " width="100%"   cellspacing="0">
    <thead>
    <tr>
        {% for columns in y_col %}
        <th>{{ columns | safe }}</th>
        {% endfor %}
    </tr>
    </thead>
    <tbody>
    {% for _, data in y_col.iterrows %}
    <tr>
        {% for value in data %}
        <td>{{ value | safe }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
    </tbody>
</table>
<table class="table table-responsive table-striped table-dark " width="100%"   cellspacing="0">
    <thead>
    <tr>
        {% for columns in df %}
        <th>{{ columns | safe }}</th>
        {% endfor %}
    </tr>
    </thead>
    <tbody>
    {% for _, data in df.iterrows %}
    <tr>
        {% for value in data %}
        <td>{{ value | safe }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endif %}

{% endblock content %}
